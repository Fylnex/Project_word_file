# Проект: Автоматизация генерации отчетов в формате DOCX и PDF

Этот проект предназначен для автоматизации процесса создания отчетов в формате DOCX и их последующей конвертации в PDF. Он построен на основе модульной архитектуры с использованием принципов ООП, что позволяет легко добавлять новые сценарии и типы отчетов.

## Структура проекта

Проект состоит из следующих модулей:

    /project_root 
    │
    ├── main.py # Основной скрипт для запуска 
    │
    ├── processors│ 
    │             ├── init.py                     # Инициализация пакета 
    │             ├── document_processor.py       # Базовый класс для обработки документов 
    │             ├── exam_report_processor.py    # Класс для обработки отчета по экзамену 
    │             └── other_report_processor.py   # Пример для обработки других отчетов 
    ├── utils│   
    │        ├── init.py       # Инициализация пакета 
    │        └── file_utils.py # Утилитарные функции для работы с файлами 
    │
    └── templates│ 
                 ├── 24_form_20.docx # Шаблон документа для экзамена
                 ├── 24_form_21.docx # Шаблон документа для экзамена
                 └── 24_form_22.docx # Шаблон документа для экзамена

### Описание модулей

#### 1. `main.py`

Основной скрипт для запуска проекта. В этом файле происходит выбор нужного сценария обработки документа (например, отчет по экзамену) и его выполнение. 

Можно добавить новый сценарий, просто импортировав соответствующий класс процессора и создав его экземпляр.



#### 2. `processors/document_processor.py`

Базовый класс `DocumentProcessor` для всех типов процессоров документов. Этот класс определяет общие методы и интерфейс, которые должны быть реализованы в каждом подклассе:
- `load_template()`: Загружает шаблон документа.
- `process()`: Абстрактный метод для обработки документа, который должен быть реализован в каждом подклассе.
- `save_document()`: Сохраняет обработанный документ.



#### 3. `processors/exam_report_processor.py`

Класс `ExamReportProcessor` — процессор для создания отчета по экзамену. Наследует от `DocumentProcessor` и реализует:
- `process()`: Метод для выполнения всех шагов обработки документа.
- `replace_flags()`: Замена флагов в шаблоне на реальные данные.
- `insert_table()`: Вставка таблицы с данными о студентах на место флага `${table}`.
- `create_table_with_borders()`: Создание таблицы с границами и правильным форматированием.



#### 4. `processors/sovet_report_processor.py`

Класс `SovetReportProcessor` — процессор для создания отчета по совету.


#### 5. `utils/file_utils.py`

Утилитарные функции для работы с файлами, такие как:
- `convert_docx_to_pdf(docx_path)`: Конвертация документа DOCX в PDF с использованием библиотеки `docx2pdf`.

### Флаги для экзамена
```
флаги = {
        '${s1}': '',    # Номер экзамеционной ведомости
        '${s2}': '',    # Семестр
        '${s3}': '',    # год
        '${s4}': '',    # год +1
        '${s5}': '',    # направление подготовик/специальность
        '${s6}': '',    # направленность/профиль
        '${s7}': '',    # курс
        '${s8}': '',    #группы
        '${s9}': '',    # Факультет
        '${s10}': '',   # Дисциплина
        '${s11}': '',   # Общее количество часов/з.ед
        '${s12}': '',   # ФИО преподавателей
        '${d1}': '',    # день проведения экзамена
        '${d2}': '',    # месяц проведения экзамена
        '${d3}': '',    # год проведения экзамена
        '${p50}': '',   # ФИО зав кафедры
        '${p100}': '',  # ФИО декана факультета
        '${p1000}': '', # декан факультета
        '${p201}': '',  # ФИО преподавателя 1
        '${p202}': '',  # ФИО преподавателя 2
        '${p203}': '',  # ФИО преподавателя 3
        '${p204}': '',  # ФИО преподавателя 4
        '${p205}': '',  # ФИО преподавателя 5
        '${table}': ''  # таблица с количеством студентов, пришедших на экзамен 
            
```
`${table}` - данная таблица должна быть динамической, ее размеры (кол-во строк) полностью зависят от количества студентов, пришедших на экзамен
 
`${p1000}`- не понятно для чего нужна данный флаг, если на его месте всегда стоит один и тот же текст: 'декан факультета'
### Расширение проекта

Чтобы добавить новый сценарий обработки документа, выполните следующие шаги:

1. **Создайте новый процессор**: В директории `processors` создайте новый файл, например, `new_report_processor.py`.
2. **Создайте класс-процессор**: В новом файле создайте класс, который наследует от `DocumentProcessor` и реализует все необходимые методы (`process()`, `replace_flags()`, `insert_table()` и т.д.).
3. **Импортируйте класс в `main.py`**: Импортируйте новый класс в `main.py` и добавьте логику для его выбора и запуска.
4. **Добавьте тесты и шаблоны**: Если необходимо, добавьте новые шаблоны документов в директорию `templates` и соответствующие тесты.

### Пример добавления нового сценария

```python
# main.py 

from processors.new_report_processor import NewReportProcessor

def main():
    # Логика для выбора нового процессора
    processor = NewReportProcessor(template_path, output_path, replacements, data)
    if processor.process():
        convert_docx_to_pdf(output_path)
