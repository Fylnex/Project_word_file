# Проект: Модуль автоматизации генерации отчетов в формате DOCX и PDF

Этот проект предназначен для автоматизации процесса создания отчетов в формате DOCX и их последующей конвертации в PDF. Он построен на основе модульной архитектуры с использованием принципов ООП, что позволяет легко добавлять новые сценарии и типы отчетов.

## Структура проекта

Проект состоит из следующих модулей:

    /report
    ├── __init__.py # Инициализация пакета 
    │
    └── generator_report.py # Основной скрипт для запуска 
                             │
                             ├── processors│ 
                             │             ├── init.py                       # Инициализация пакета 
                             │             ├── document_processor.py         # Базовый класс для обработки документов 
                             │             ├── student_report_processor.py    # Класс для обработки отчета по студентам
                             │             ├── employee_report_processor.py   # Класс для обработки отчета по сотрудникам
                             │             ├── exam_report_processor.py      # Класс для обработки отчета по экзамену 
                             │             └── counsil_report_processor.py   # Класс для обработки научного совета 
                             │               
                             ├── utils│   
                             │        ├── init.py       # Инициализация пакета 
                             │        └── file_utils.py # Утилитарные функции для работы с файлами 
                             │
                             └── templates│ 
                                          ├── counsil # Научный совет
                                          │          └── form_app_01.docx# Шаблон документа для научного совета
                                          ├── exam # Экзамен
                                          │          ├──24_form_20.docx # Шаблон документа для экзамена
                                          │          ├── 24_form_21.docx # Шаблон документа для экзамена
                                          │          └── 24_form_22.docx # Шаблон документа для экзамена
                                          ├── student # Отчет по студентам
                                          └── employee # Отчет по сотрудникам
                               

### Описание модулей

#### 1. `main.py`

Основной скрипт для запуска проекта. В этом файле происходит выбор нужного сценария обработки документа (например, отчет по экзамену) и его выполнение. 

Можно добавить новый сценарий, просто импортировав соответствующий класс процессора и создав его экземпляр.



#### 2. `processors/document_processor.py`

Базовый класс `DocumentProcessor` для всех типов процессоров документов. Этот класс определяет общие методы и интерфейс, которые должны быть реализованы в каждом подклассе:
- `load_template()`: Загружает шаблон документа.
- `process()`: Абстрактный метод для обработки документа, который должен быть реализован в каждом подклассе.
- `save_document()`: Сохраняет обработанный документ.



#### 3. `processors/exam_report_processor.py`

Класс `ExamReportProcessor` — процессор для создания отчета по экзамену. Наследует от `DocumentProcessor` и реализует:
- `process()`: Метод для выполнения всех шагов обработки документа.
- `replace_flags()`: Замена флагов в шаблоне на реальные данные.
- `insert_table()`: Вставка таблицы с данными о студентах на место флага `${table}`.
- `create_table_with_borders()`: Создание таблицы с границами и правильным форматированием.



#### 4. `processors/counsil_report_processor.py`

Класс `CounsilReportProcessor` — методы для создания отчета по научному совету.


#### 5. `processors/employee_report_processor.py`

Класс `EmployeeReportProcessor` — методы для создания отчета по сотрудникам.


#### 6. `processors/student_report_processor.py`

Класс `StudentReportProcessor` — методы для создания отчета по студентам.


#### 7. `utils/file_utils.py`

Утилитарные функции для работы с файлами, такие как:
- `convert_docx_to_pdf(docx_path)`: Конвертация документа DOCX в PDF с использованием библиотеки `docx2pdf`.




### Флаги для состояния 'экзамен'
```
флаги = {
        '${s1}': '',    # Номер экзамеционной ведомости
        '${s2}': '',    # Семестр
        '${s3}': '',    # год
        '${s4}': '',    # год +1
        '${s5}': '',    # направление подготовик/специальность
        '${s6}': '',    # направленность/профиль
        '${s7}': '',    # курс
        '${s8}': '',    #группы
        '${s9}': '',    # Факультет
        '${s10}': '',   # Дисциплина
        '${s11}': '',   # Общее количество часов/з.ед
        '${s12}': '',   # ФИО преподавателей
        '${d1}': '',    # день проведения экзамена
        '${p50}': '',   # ФИО зав кафедры
        '${p100}': '',  # ФИО декана факультета
        '${p1000}': '', # декан факультета
        '${p201}': '',  # ФИО преподавателя 1
        '${p202}': '',  # ФИО преподавателя 2
        '${p203}': '',  # ФИО преподавателя 3
        '${p204}': '',  # ФИО преподавателя 4
        '${p205}': '',  # ФИО преподавателя 5
        '${table}': ''  # таблица с количеством студентов, пришедших на экзамен 
            
```
`${table}` - данная таблица должна быть динамической, ее размеры (кол-во строк) полностью зависят от количества студентов, пришедших на экзамен
 
`${p1000}`- не понятно для чего нужна данный флаг, если на его месте всегда стоит один и тот же текст: 'декан факультета'

### Флаги для состояния 'научный совет'
```
replacements = {
        '${d1}': f"{date_today[2]}.{date_today[1]}.{date_today[0]}", #date_today,
        '${s1}': '08',
        '${s2}': '24',
        '${s3}': f'{len(employees_data)}',
        '${s4}': f"{int(len(employees_data)*2/3)}",

    }
```